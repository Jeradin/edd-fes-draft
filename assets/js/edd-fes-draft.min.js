!function(e){function t(t){var d,a=t.serialize(),s=[];return e(".fes-rich-validation").each(function(t,a){d=e(a).data("id"),val=e.trim(tinyMCE.get(d).getContent()),s.push(d+"="+encodeURIComponent(val))}),a+="&"+s.join("&")}0!=e('form[name="fes-submission-form"]').length&&(e("#edd-fes-draft-button").click(function(){var t=e('form[name="fes-submission-form"]');0==t.find('input[type="hidden"][name="save_draft"]').length&&t.append('<input type="hidden" name="save_draft" value="true" />'),t.submit()}),edd_fes_draft.auto_save&&e('form[name="fes-submission-form"] input:not(#edd_fes_draft_pending_checkbox), form[name="fes-submission-form"] textarea, form[name="fes-submission-form"] select').change(function(){var d=e(this).closest("form"),a=t(d),s=edd_fes_draft.pending_checkbox?"#edd-fes-draft-button":'#edd-fes-draft-button, input[type="submit"]';a&&(a+="&save_draft=1",a.replace("action=fes_submit_submission_form","action=edd_fes_draft_auto_save"),e(".edd-fes-draft-submit").append('<span class="edd-fes-draft-auto-save-text">Saving...</span>'),e(s).attr("disabled","disabled").addClass("button-primary-disabled"),e.post(edd_fes_draft.ajax_url,a,function(t){window.history.pushState(document.innerHTML,document.title,window.location.origin+window.location.pathname+"?task=edit-product&post_id="+t.post_id),d.find('[name="post_id"]').val(t.post_id),e(".edd-fes-draft-submit .edd-fes-draft-auto-save-text").fadeOut(function(){e(this).remove()}),e(s).removeAttr("disabled").removeClass("button-primary-disabled")}))}),edd_fes_draft.pending_checkbox&&(e('input[type="submit"]').attr("disabled","disabled"),e("#edd_fes_draft_pending_checkbox").change(function(){e(this).prop("checked")?e('input[type="submit"]').removeAttr("disabled"):e('input[type="submit"]').attr("disabled","disabled")})))}(jQuery);